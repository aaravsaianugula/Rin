<Window x:Class="OverlayApp.TrayMenuWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Rin Tray" Height="260" Width="220"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        Topmost="True" ShowInTaskbar="False" Deactivated="Window_Deactivated">
    
    <Window.Resources>
        <!-- Following FluidOverlay design system colors -->
        <Color x:Key="Surface">#1A1A1A</Color>
        <Color x:Key="SurfaceElevated">#242424</Color>
        <Color x:Key="TextPrimary">#F5F5F5</Color>
        <Color x:Key="TextSecondary">#A0A0A0</Color>
        <Color x:Key="TextMuted">#666666</Color>
        <Color x:Key="StatusError">#B57A7A</Color>
        <Color x:Key="GlassBorder">#33FFFFFF</Color>
        <Color x:Key="GlassBorderBottom">#15FFFFFF</Color>
        
        <SolidColorBrush x:Key="GlassBackgroundBrush" Color="#F0181818"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource TextPrimary}"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="{StaticResource TextSecondary}"/>
        <SolidColorBrush x:Key="TextMutedBrush" Color="{StaticResource TextMuted}"/>
        <SolidColorBrush x:Key="StatusErrorBrush" Color="{StaticResource StatusError}"/>
        
        <LinearGradientBrush x:Key="GlassBorderBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="{StaticResource GlassBorder}" Offset="0"/>
            <GradientStop Color="{StaticResource GlassBorderBottom}" Offset="1"/>
        </LinearGradientBrush>
        
        <Style x:Key="TrayItemStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root" Background="{TemplateBinding Background}" CornerRadius="8" Margin="4,2" Padding="12,0">
                            <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Left"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Root" Property="Background" Value="#15FFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Root" Property="Background" Value="#20FFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="TrayItemDangerStyle" TargetType="Button" BasedOn="{StaticResource TrayItemStyle}">
            <Setter Property="Foreground" Value="{StaticResource StatusErrorBrush}"/>
        </Style>
    </Window.Resources>

    <Border Background="{StaticResource GlassBackgroundBrush}" 
            CornerRadius="14" 
            BorderBrush="{StaticResource GlassBorderBrush}" 
            BorderThickness="1" 
            Margin="10">
        <Border.Effect>
            <DropShadowEffect BlurRadius="32" ShadowDepth="6" Opacity="0.5" Color="#000000"/>
        </Border.Effect>
        <StackPanel Margin="6">
            <!-- Header -->
            <Border Padding="14,10,14,12" BorderThickness="0,0,0,1" BorderBrush="#20FFFFFF">
                <StackPanel Orientation="Horizontal">
                    <Image Source="pack://application:,,,/rin_logo.png" 
                           Width="22" Height="22" RenderOptions.BitmapScalingMode="HighQuality"/>
                    <TextBlock Text="Rin Agent" 
                               FontSize="14" 
                               FontWeight="SemiBold" 
                               Foreground="{StaticResource TextPrimaryBrush}" 
                               VerticalAlignment="Center" 
                               Margin="12,0,0,0"
                               FontFamily="Segoe UI Variable Display, Segoe UI"/>
                </StackPanel>
            </Border>

            <!-- Actions -->
            <Button Style="{StaticResource TrayItemStyle}" Click="OpenDashboard_Click" Margin="0,4,0,0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="&#xE80F;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,14,0" VerticalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Text="Open Dashboard" FontSize="13" VerticalAlignment="Center" FontFamily="Segoe UI Variable Display, Segoe UI"/>
                </StackPanel>
            </Button>
            
            <Button Style="{StaticResource TrayItemStyle}" Click="ToggleOverlay_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="&#xE81E;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,14,0" VerticalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Text="Toggle Overlay" FontSize="13" VerticalAlignment="Center" FontFamily="Segoe UI Variable Display, Segoe UI"/>
                </StackPanel>
            </Button>

            <Border Height="1" Background="#15FFFFFF" Margin="12,8"/>

            <Button Style="{StaticResource TrayItemStyle}" Click="RestartAgent_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="&#xE72C;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,14,0" VerticalAlignment="Center" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Text="Restart Agent" FontSize="13" VerticalAlignment="Center" FontFamily="Segoe UI Variable Display, Segoe UI"/>
                </StackPanel>
            </Button>

            <Button Style="{StaticResource TrayItemDangerStyle}" Click="Exit_Click">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="&#xE7E8;" FontFamily="Segoe MDL2 Assets" FontSize="14" Margin="0,0,14,0" VerticalAlignment="Center" Foreground="{StaticResource StatusErrorBrush}"/>
                    <TextBlock Text="Exit Rin" FontSize="13" FontWeight="SemiBold" VerticalAlignment="Center" FontFamily="Segoe UI Variable Display, Segoe UI"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Border>
</Window>
